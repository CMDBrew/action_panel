%dropdown-to-menu {
  &.navbar-dark  .dropdown-item a { color: $yiq-text-light; }
  &.navbar-light .dropdown-item a { color: $yiq-text-dark; }

  .dropdown-toggle {
    &::after { display: none; }

    &::before {
      @extend .dropdown-toggle::after;
      display: inline-block;
      margin-right: map-get($spacers, 1);
    }
  }

  .dropdown-menu {
    position: static !important;
    padding: 0;
    border: 0;

    @include transform(none);

    &,
    .dropdown-item:hover {
      background: transparent;
    }

    .dropdown-item {
      padding: 0;
      background: transparent;

      a {
        @extend .nav-link;
        padding-right: $nav-link-padding-x !important;
        padding-left: $nav-link-padding-x !important;
      }
    }
  }
}

%navigation-sidebar-base {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  z-index: $zindex-fixed;
  align-items: flex-start;
  flex-direction: column;
  padding: 0;
  overflow: hidden;

  @at-root {
    #header-backdrop { z-index: $zindex-fixed - 1; }

    &.show + #header-backdrop { display: block; }
  }

  .navbar-nav { width: 100%; }

  .nav-item > .nav-link {
    @extend .dropdown-toggle;
    &:not(.dropdown-toggle)::before { visibility: hidden; }
  }

  .nav-link,
  .navbar-brand {
    padding-right: $nav-link-padding-x;
    padding-left: $nav-link-padding-x;
    white-space: nowrap;
  }

  .navbar-brand {
    width: 100%;
    margin: 0;
  }

  #header-nav {
    display: flex;
    flex: 1;

    &,
    .navbar-nav {
      flex-direction: column;
      width: 100%;
    }
  }

  #main-nav {
    flex: 1;
    overflow-y: auto;
  }
}

%navigation-top-base {
  min-height: $header-height;
  #main-nav { @extend .mr-auto; }
  .dropdown-item a { color: inherit; }

  .navbar-nav {
    @include media-breakpoint-up($sidebar-breakpoint) {
      align-items: center;
    }
  }
}

%navigation-fixed-top {
  @extend %navigation-top-base;

  position: fixed;
  top: 0;
  right: 0;
  left: 0;
  z-index: $zindex-fixed;
}

%titlebar-fixed-top {
  position: fixed;
  right: 0;
  z-index: $zindex-fixed - 5;
}

%navigation-top {
  @extend %navigation-top-base;
}

%navigation-sidebar {
  @extend %dropdown-to-menu;
  @extend %navigation-sidebar-base;
  display: flex;

  @at-root {
    &,
    #title_bar,
    #wrapper {
      @include transition(all 0.2s linear);
    }
  }

  .navbar-brand {
    display: flex;
    align-items: center;
    height: $titlebar-height;
  }
}

@include navigation('top') {
  #header { @extend %navigation-top; }
}

@include navigation('fixed_top') {
  $_offset-top: calc(#{$header-height} + #{$titlebar-height});
  padding-top: $_offset-top;

  .slide-pane { top: $_offset-top; }
  #header { @extend %navigation-fixed-top; }

  #titlebar-wrapper {
    @extend %titlebar-fixed-top;
    top: $header-height;
    left: 0;
  }
}

@include navigation('sidebar') {
  padding-top: $titlebar-height;
  padding-left: map-get($header-sidebar-width, 'expand');

  #header {
    @extend %navigation-sidebar;
    width: map-get($header-sidebar-width, 'expand');
    height: 100%;
  }

  .slide-pane { top: $titlebar-height; }

  #titlebar-wrapper {
    @extend %titlebar-fixed-top;
    top: 0;
    left: map-get($header-sidebar-width, 'expand');

    .navbar-toggler { display: none; }
  }

  @include media-breakpoint-down(#{nth($breakpoints, index($breakpoints, map-get($header-breakpoints, 'sidebar')))}) {
    padding-left: 0;

    #header {
      width: 100%;
      max-width: map-get($header-sidebar-width, 'collapse');
    }

    #titlebar-wrapper {
      left: 0;
      .navbar-toggler { display: block; }
    }

    #header {
      @include transform(translateX(-100%));

      &.show {
        @include transform(translateX(0%));

        @at-root {
          body.header-active { overflow: hidden; }
        }
      }
    }
  }
}

